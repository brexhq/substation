// This example shows how to read a Parquet file and send the contents to stdout.
local sub = std.extVar('sub');

{
  tests: [
    {
      name: 'parquet',
      transforms: [
        // This is a Parquet file containing two rows and two columns (Name, Age).
        sub.tf.test.message({ value: 'UEFSMRUEFSAVJEwVBBUAEgAAEDwFAAAAQWxpY2UDAAAAQm9iFQAVBhUKLBUEFRAVBhUGHDYAKANCb2IYBUFsaWNlAAAAAwgBAwIVBBUQFRRMFQQVABIAAAgcHgAAABkAAAAVABUGFQosFQQVEBUGFQYcGAQeAAAAGAQZAAAAFgAoBB4AAAAYBBkAAAAAAAADCAEDAhUEGTw1ABgGc2NoZW1hFQQAFQwlABgEbmFtZSUATBwAAAAVAiUAGANhZ2UAFgQZHBksJgAcFQwZNQAGEBkYBG5hbWUVAhYEFoQBFowBJkgmCBw2ACgDQm9iGAVBbGljZQAZLBUEFQAVAgAVABUQFQIAPBYQGQYZBgAAACYAHBUCGTUABhAZGANhZ2UVAhYEFowBFpQBJsQBJpQBHBgEHgAAABgEGQAAABYAKAQeAAAAGAQZAAAAABksFQQVABUCABUAFRAVAgAAABaQAhYEJggWoAIAGSwYBnBhbmRhcxjeAnsiaW5kZXhfY29sdW1ucyI6IFtdLCAiY29sdW1uX2luZGV4ZXMiOiBbXSwgImNvbHVtbnMiOiBbeyJuYW1lIjogIm5hbWUiLCAiZmllbGRfbmFtZSI6ICJuYW1lIiwgInBhbmRhc190eXBlIjogInVuaWNvZGUiLCAibnVtcHlfdHlwZSI6ICJvYmplY3QiLCAibWV0YWRhdGEiOiBudWxsfSwgeyJuYW1lIjogImFnZSIsICJmaWVsZF9uYW1lIjogImFnZSIsICJwYW5kYXNfdHlwZSI6ICJpbnQzMiIsICJudW1weV90eXBlIjogImludDY0IiwgIm1ldGFkYXRhIjogbnVsbH1dLCAiY3JlYXRvciI6IHsibGlicmFyeSI6ICJweWFycm93IiwgInZlcnNpb24iOiAiMjAuMC4wIn0sICJwYW5kYXNfdmVyc2lvbiI6ICIyLjMuMCJ9ABgMQVJST1c6c2NoZW1hGIwGLy8vLy8wQUNBQUFRQUFBQUFBQUtBQTRBQmdBRkFBZ0FDZ0FBQUFBQkJBQVFBQUFBQUFBS0FBd0FBQUFFQUFnQUNnQUFBSlFCQUFBRUFBQUFBUUFBQUF3QUFBQUlBQXdBQkFBSUFBZ0FBQUJzQVFBQUJBQUFBRjRCQUFCN0ltbHVaR1Y0WDJOdmJIVnRibk1pT2lCYlhTd2dJbU52YkhWdGJsOXBibVJsZUdWeklqb2dXMTBzSUNKamIyeDFiVzV6SWpvZ1czc2libUZ0WlNJNklDSnVZVzFsSWl3Z0ltWnBaV3hrWDI1aGJXVWlPaUFpYm1GdFpTSXNJQ0p3WVc1a1lYTmZkSGx3WlNJNklDSjFibWxqYjJSbElpd2dJbTUxYlhCNVgzUjVjR1VpT2lBaWIySnFaV04wSWl3Z0ltMWxkR0ZrWVhSaElqb2diblZzYkgwc0lIc2libUZ0WlNJNklDSmhaMlVpTENBaVptbGxiR1JmYm1GdFpTSTZJQ0poWjJVaUxDQWljR0Z1WkdGelgzUjVjR1VpT2lBaWFXNTBNeklpTENBaWJuVnRjSGxmZEhsd1pTSTZJQ0pwYm5RMk5DSXNJQ0p0WlhSaFpHRjBZU0k2SUc1MWJHeDlYU3dnSW1OeVpXRjBiM0lpT2lCN0lteHBZbkpoY25raU9pQWljSGxoY25KdmR5SXNJQ0oyWlhKemFXOXVJam9nSWpJd0xqQXVNQ0o5TENBaWNHRnVaR0Z6WDNabGNuTnBiMjRpT2lBaU1pNHpMakFpZlFBQUJnQUFBSEJoYm1SaGN3QUFBZ0FBQUV3QUFBQUVBQUFBelAvLy93QUFBQUlRQUFBQUhBQUFBQVFBQUFBQUFBQUFBd0FBQUdGblpRQUlBQXdBQ0FBSEFBZ0FBQUFBQUFBQklBQUFBQkFBRkFBSUFBQUFCd0FNQUFBQUVBQVFBQUFBQUFBQUJSQUFBQUFjQUFBQUJBQUFBQUFBQUFBRUFBQUFibUZ0WlFBQUFBQUVBQVFBQkFBQUFBQUFBQUE9ABggcGFycXVldC1jcHAtYXJyb3cgdmVyc2lvbiAyMC4wLjAZLBwAABwAAACJBQAAUEFSMQ==' }),
        sub.tf.fmt.from.b64(),
      ],
      // Asserts that each message is not empty.
      condition: sub.cnd.num.len.gt({ value: 0 }),
    },
  ],
  transforms: [
    // Read the Parquet file.
    sub.tf.format.from.parquet(),
    // Send the messages to stdout.
    sub.tf.send.stdout(),
  ],
}
